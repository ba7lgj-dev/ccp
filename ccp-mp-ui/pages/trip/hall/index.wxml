<view class="trip-hall-page">
  <view class="campus-bar">
    <text class="campus-name">当前校区：{{selectedCampus.campusName}}</text>
    <button size="mini" bindtap="onChangeCampus">切换校区</button>
  </view>
  <scroll-view scroll-y="true" class="hall-scroll" refresher-enabled="true" refresher-triggered="{{refresherTriggered}}" bindrefresherrefresh="onRefresherRefresh">
    <view class="section">
      <text class="section-title">立即拼车</text>
      <block wx:if="{{immediateList.length}}">
        <block wx:for="{{immediateList}}" wx:key="id">
          <view class="trip-card" bindtap="onTapTrip" data-id="{{item.id}}">
            <view class="unread-badge" wx:if="{{item.unreadCount}}">{{item.unreadCount > 99 ? '99+' : item.unreadCount}}</view>
            <view class="addresses">
              <text class="start">{{item.startAddress}}</text>
              <text class="arrow">→</text>
              <text class="end">{{item.endAddress}}</text>
            </view>
            <view class="meta">
              <text class="time">{{item.departureTimeFormat}}</text>
              <text class="people">{{item.currentPeople || item.ownerPeopleCount || 1}} / {{item.totalPeople}} 人</text>
            </view>
            <view class="tags">
              <text class="tag">{{item.requireText ? item.requireText.slice(0,20) : '无特殊要求'}}</text>
            </view>
          </view>
        </block>
      </block>
      <block wx:else>
        <view class="empty">当前暂无立即拼车</view>
      </block>
    </view>

    <view class="section">
      <text class="section-title">预约拼车</text>
      <block wx:if="{{reserveList.length}}">
        <block wx:for="{{reserveList}}" wx:key="id">
          <view class="trip-card" bindtap="onTapTrip" data-id="{{item.id}}">
            <view class="unread-badge" wx:if="{{item.unreadCount}}">{{item.unreadCount > 99 ? '99+' : item.unreadCount}}</view>
            <view class="addresses">
              <text class="start">{{item.startAddress}}</text>
              <text class="arrow">→</text>
              <text class="end">{{item.endAddress}}</text>
            </view>
            <view class="meta">
              <text class="time">{{item.departureTimeFormat}}</text>
              <text class="people">{{item.currentPeople || item.ownerPeopleCount || 1}} / {{item.totalPeople}} 人</text>
            </view>
            <view class="tags">
              <text class="tag">{{item.requireText ? item.requireText.slice(0,20) : '无特殊要求'}}</text>
            </view>
          </view>
        </block>
      </block>
      <block wx:else>
        <view class="empty">暂无预约拼车</view>
      </block>
    </view>
  </scroll-view>
</view>
