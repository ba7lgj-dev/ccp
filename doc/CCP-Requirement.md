# 校园拼车系统需求说明书

## 1 引言

### 1.1 编写目的
本需求说明书旨在为校园拼车系统的开发提供详细的需求描述，作为课程设计/期末大作业的开发依据。文档明确了系统的功能需求、非功能需求、用户角色、业务流程等，确保开发团队和评审教师对系统有清晰一致的理解。

### 1.2 项目背景
随着高校扩招和校园规模扩大，学生出行需求日益增长。传统的出行方式（如公共交通、出租车）存在成本高、等待时间长、灵活性差等问题。校园拼车系统旨在为在校学生提供一个安全、便捷、经济的拼车平台，解决学生出行痛点，同时促进校园绿色出行和资源共享。

### 1.3 术语和缩略语说明
| 术语/缩略语 | 说明 |
|------------|------|
| 小程序端 | 基于微信小程序开发的用户端应用 |
| 后台管理端 | 基于若依框架开发的管理后台 |
| 拼车订单 | 用户发布的拼车请求，包含起点、终点、时间、人数等信息 |
| 立即出行 | 发布后立即生效的拼车订单 |
| 预约单 | 提前发布的、未来某个时间点出发的拼车订单 |
| 实名认证 | 用户提交真实姓名、身份证号等信息，经过后台审核后获得的认证状态 |
| 学校认证 | 用户提交学生证信息，经过后台审核后获得的学校归属认证 |
| 拼车大厅 | 展示所有可加入的拼车订单的页面 |
| 行程 | 已确认的拼车订单，包含出发时间、路线、参与人员等信息 |
| JWT | JSON Web Token，用于身份验证的令牌 |
| CCP | Campus Carpooling Platform，校园拼车平台 |

### 1.4 文档结构说明
本需求说明书分为六个主要部分：
1. 引言：介绍文档目的、项目背景、术语定义和文档结构
2. 总体描述：描述项目总体目标、用户角色、运行环境和业务范围
3. 功能性需求：详细描述各模块的功能需求和业务流程
4. 非功能性需求：描述系统的性能、安全、可用性和可扩展性需求
5. 其他说明：描述与第三方服务的依赖和与若依框架的约束

## 2 总体描述

### 2.1 项目总体目标
校园拼车系统旨在构建一个安全、便捷、高效的校园拼车平台，主要实现以下目标：
- 为学生提供便捷的拼车发布和查询功能
- 确保拼车用户的身份真实性和安全性
- 实现拼车行程的全流程管理
- 提供实时聊天和消息通知功能
- 支持后台管理和审核功能
- 构建用户信誉评价体系

### 2.2 用户角色及使用场景

#### 2.2.1 普通学生用户（小程序端）
- **使用场景**：学生通过微信小程序使用拼车服务
- **核心功能**：
  - 微信登录和账号管理
  - 实名认证和学校认证
  - 发布拼车订单
  - 浏览拼车大厅和加入拼车
  - 查看订单详情和行程状态
  - 参与拼车聊天
  - 查看个人中心和历史订单
  - 评价拼车体验

#### 2.2.2 平台管理员（后台若依系统）
- **使用场景**：系统管理员通过后台管理系统管理平台
- **核心功能**：
  - 学校、校区、校门信息管理
  - 校外地点管理
  - 小程序用户管理
  - 实名认证和学校认证审核
  - 拼车订单管理和干预
  - 用户信誉和评价管理
  - 系统配置和日志管理

#### 2.2.3 学校/校区管理员（可选）
- **使用场景**：学校或校区指定的管理员管理本学校/校区的拼车服务
- **核心功能**：
  - 管理本学校/校区的基础信息
  - 审核本学校学生的认证申请
  - 管理本学校/校区的拼车订单
  - 查看本学校/校区的统计数据

### 2.3 运行环境概述

#### 2.3.1 后端
- **框架**：Spring Boot + RuoYi
- **JDK**：1.8 或以上
- **Maven**：3.6 或以上
- **数据库**：MySQL 8.0
- **缓存**：Redis（可选）

#### 2.3.2 小程序
- **框架**：微信小程序框架
- **UI组件库**：ccp-mp-ui
- **开发工具**：微信开发者工具

#### 2.3.3 管理端
- **前端框架**：Vue.js
- **UI组件库**：Element UI
- **开发工具**：Visual Studio Code 或其他前端开发工具

### 2.4 业务范围概述

#### 2.4.1 基础管理
- 学校信息管理
- 校区信息管理
- 校门信息管理
- 地点信息管理

#### 2.4.2 小程序登录和用户管理
- 微信登录集成
- 用户信息同步和存储
- Token管理和身份验证

#### 2.4.3 实名认证
- 实名认证信息提交
- 后台审核流程
- 认证状态管理

#### 2.4.4 学校认证
- 学校选择和校区选择
- 学生证信息提交
- 后台审核流程
- 认证状态管理

#### 2.4.5 拼车核心功能
- 拼车发布（立即出行/预约出行）
- 拼车大厅浏览和筛选
- 拼车加入和退出
- 拼车确认和成团
- 行程状态管理

#### 2.4.6 聊天和消息
- 拼车群聊功能
- 系统消息通知
- 消息已读状态管理

#### 2.4.7 审核与风控
- 黑名单管理
- 用户信誉评价
- 异常行为监控

#### 2.4.8 统计与日志
- 操作日志记录
- 行程日志记录
- 用户行为分析

## 3 功能性需求

### 3.1 小程序端功能需求

#### 3.1.1 登录与账号管理
- **功能说明**：用户通过微信登录小程序，获取身份令牌，管理个人信息
- **参与角色**：普通学生用户
- **前置条件**：微信账号已绑定手机号
- **后置条件**：用户成功登录，获得访问令牌
- **正常流程**：
  1. 用户打开小程序，点击登录按钮
  2. 调用微信登录接口，获取code
  3. 将code发送到后端，换取openid和session_key
  4. 后端生成JWT令牌，返回给前端
  5. 前端存储令牌，登录成功
- **主要异常情况**：
  - 微信登录失败
  - 后端验证失败
  - 令牌过期

#### 3.1.2 实名认证流程
- **功能说明**：用户提交真实姓名、身份证号等信息，经过后台审核后获得实名认证
- **参与角色**：普通学生用户、平台管理员
- **前置条件**：用户已登录
- **后置条件**：用户获得实名认证状态
- **正常流程**：
  1. 用户进入实名认证页面
  2. 填写真实姓名、身份证号等信息
  3. 上传身份证照片（可选）
  4. 提交认证申请
  5. 后台管理员审核申请
  6. 审核通过后，用户获得实名认证
- **主要异常情况**：
  - 认证信息填写不完整
  - 身份证号格式不正确
  - 认证审核不通过

#### 3.1.3 学校认证与学校选择、校区选择
- **功能说明**：用户选择学校和校区，提交学生证信息，获得学校认证
- **参与角色**：普通学生用户、平台管理员
- **前置条件**：用户已登录，已完成实名认证
- **后置条件**：用户获得学校认证状态
- **正常流程**：
  1. 用户进入学校认证页面
  2. 选择学校和校区
  3. 填写学号、姓名等信息
  4. 上传学生证照片
  5. 提交认证申请
  6. 后台管理员审核申请
  7. 审核通过后，用户获得学校认证
- **主要异常情况**：
  - 学校或校区选择错误
  - 学生证信息填写不完整
  - 认证审核不通过

#### 3.1.4 拼车大厅浏览、筛选、下拉刷新、状态标签
- **功能说明**：用户浏览所有可加入的拼车订单，支持筛选和刷新
- **参与角色**：普通学生用户
- **前置条件**：用户已登录，已完成实名认证和学校认证
- **后置条件**：用户查看拼车订单列表
- **正常流程**：
  1. 用户进入拼车大厅页面
  2. 系统显示当前校区的拼车订单
  3. 用户可通过筛选条件（如出发时间、目的地、人数）筛选订单
  4. 用户可下拉刷新获取最新订单
  5. 订单显示状态标签（如招募中、待确认、已完成）
- **主要异常情况**：
  - 网络连接失败
  - 没有符合条件的订单

#### 3.1.5 拼车发布（立即出行/预约出行、人数限制、时间校验）
- **功能说明**：用户发布拼车订单，可选择立即出行或预约出行，设置人数限制和出发时间
- **参与角色**：普通学生用户
- **前置条件**：用户已登录，已完成实名认证和学校认证
- **后置条件**：拼车订单成功发布
- **正常流程**：
  1. 用户进入发布拼车页面
  2. 选择出发地和目的地
  3. 选择出发时间（立即出行或预约时间）
  4. 设置总人数和发起方人数
  5. 填写拼车要求和备注
  6. 提交发布
  7. 系统校验时间和人数限制
  8. 发布成功，生成拼车订单
- **主要异常情况**：
  - 出发时间早于当前时间（预约单）
  - 人数设置不合理
  - 出发地和目的地相同

#### 3.1.6 拼车详情（加入、退出、确认、踢人等）
- **功能说明**：用户查看拼车订单详情，可加入、退出、确认拼车，发起者可踢人
- **参与角色**：普通学生用户
- **前置条件**：用户已登录，已完成实名认证和学校认证
- **后置条件**：拼车订单状态更新
- **正常流程**：
  1. 用户进入拼车详情页面
  2. 查看订单信息、发起者信息和已加入成员
  3. 未加入用户可点击加入按钮，填写同行人数
  4. 已加入用户可点击退出按钮
  5. 拼车进入确认阶段后，用户可点击确认按钮
  6. 发起者可踢除成员
- **主要异常情况**：
  - 订单已过期或已完成
  - 加入人数超过剩余名额
  - 无权限操作（如非发起者尝试踢人）

#### 3.1.7 聊天功能（消息发送、系统消息、已读）
- **功能说明**：拼车成员可在订单内进行实时聊天，查看系统消息，标记消息已读
- **参与角色**：普通学生用户
- **前置条件**：用户已加入拼车订单
- **后置条件**：消息成功发送，已读状态更新
- **正常流程**：
  1. 用户进入拼车聊天页面
  2. 查看历史聊天记录
  3. 发送文本消息
  4. 接收系统消息（如有人加入、退出、确认）
  5. 系统自动标记消息为已读
- **主要异常情况**：
  - 网络连接失败
  - 用户已退出拼车订单

#### 3.1.8 我的页面（个人信息、历史订单、当前进行中订单、学校认证入口等）
- **功能说明**：用户查看和管理个人信息、订单记录，进入认证页面
- **参与角色**：普通学生用户
- **前置条件**：用户已登录
- **后置条件**：用户查看或更新个人信息，查看订单记录
- **正常流程**：
  1. 用户进入我的页面
  2. 查看个人信息（头像、昵称、认证状态）
  3. 查看当前进行中的订单
  4. 查看历史订单记录
  5. 进入实名认证和学校认证页面
  6. 管理常用路线
- **主要异常情况**：
  - 无订单记录
  - 认证状态异常

### 3.2 后台管理端功能需求

#### 3.2.1 学校/校区/校门管理
- **功能说明**：管理员管理学校、校区和校门信息
- **参与角色**：平台管理员
- **前置条件**：管理员已登录后台
- **后置条件**：学校/校区/校门信息成功添加、修改或删除
- **正常流程**：
  1. 管理员进入学校管理页面
  2. 点击添加按钮，填写学校信息
  3. 进入校区管理页面，添加校区信息
  4. 进入校门管理页面，添加校门信息
  5. 可修改或删除已有信息
- **主要异常情况**：
  - 信息填写不完整
  - 存在关联数据（如删除有校区的学校）

#### 3.2.2 校外地点管理
- **功能说明**：管理员管理校外地点信息，如地铁站、商超、公交站等
- **参与角色**：平台管理员
- **前置条件**：管理员已登录后台
- **后置条件**：地点信息成功添加、修改或删除
- **正常流程**：
  1. 管理员进入地点管理页面
  2. 点击添加按钮，填写地点名称、类型、经纬度等信息
  3. 选择所属校区
  4. 可修改或删除已有地点
- **主要异常情况**：
  - 经纬度格式不正确
  - 地点名称重复

#### 3.2.3 小程序用户管理（实名信息、学校认证信息、封禁等）
- **功能说明**：管理员管理小程序用户，查看实名和学校认证信息，可封禁用户
- **参与角色**：平台管理员
- **前置条件**：管理员已登录后台
- **后置条件**：用户信息成功更新，用户状态变更
- **正常流程**：
  1. 管理员进入用户管理页面
  2. 查看用户列表，可筛选和搜索
  3. 点击用户详情，查看实名和学校认证信息
  4. 可封禁或解封用户
  5. 可修改用户状态和备注
- **主要异常情况**：
  - 封禁已封禁用户
  - 解封未封禁用户

#### 3.2.4 实名审核、学校认证审核
- **功能说明**：管理员审核用户提交的实名认证和学校认证申请
- **参与角色**：平台管理员
- **前置条件**：管理员已登录后台，存在待审核的认证申请
- **后置条件**：认证申请状态更新
- **正常流程**：
  1. 管理员进入认证审核页面
  2. 查看待审核的认证申请列表
  3. 点击查看详情，审核认证材料
  4. 点击通过或拒绝，填写审核意见
  5. 系统更新认证状态，通知用户
- **主要异常情况**：
  - 认证材料不清晰
  - 信息不一致

#### 3.2.5 拼车订单管理（查询、导出、人工干预）
- **功能说明**：管理员管理拼车订单，可查询、导出和人工干预订单状态
- **参与角色**：平台管理员
- **前置条件**：管理员已登录后台
- **后置条件**：订单信息成功查询、导出或状态更新
- **正常流程**：
  1. 管理员进入订单管理页面
  2. 查看订单列表，可筛选和搜索
  3. 点击订单详情，查看订单信息和成员列表
  4. 可导出订单数据
  5. 可人工干预订单状态（如取消、完成）
- **主要异常情况**：
  - 订单状态异常
  - 导出数据失败

#### 3.2.6 用户信誉与评价查看
- **功能说明**：管理员查看用户信誉评分和评价记录
- **参与角色**：平台管理员
- **前置条件**：管理员已登录后台
- **后置条件**：用户信誉和评价信息成功查看
- **正常流程**：
  1. 管理员进入用户信誉页面
  2. 查看用户信誉列表，可筛选和搜索
  3. 点击用户详情，查看评价记录和评分明细
  4. 可查看爽约记录和黑名单状态
- **主要异常情况**：
  - 无评价记录
  - 用户信誉数据异常

## 4 非功能性需求

### 4.1 性能需求
- **并发量预期**：支持1000并发用户访问
- **响应时间**：
  - 普通查询请求：≤200ms
  - 复杂查询请求：≤500ms
  - 页面加载时间：≤1s
- **分页策略**：
  - 列表页默认每页显示10条数据
  - 支持自定义每页显示数量（10/20/50）
  - 大数据量查询采用分页加载

### 4.2 安全需求
- **登录鉴权**：
  - 采用JWT令牌进行身份验证
  - 令牌有效期为7天
  - 支持令牌刷新机制
- **权限控制**：
  - 后台管理端基于角色的访问控制（RBAC）
  - 小程序端基于认证状态的功能访问控制
- **数据脱敏**：
  - 身份证号显示前6位和后4位，中间用*替换
  - 手机号显示前3位和后4位，中间用*替换
- **数据加密**：
  - 敏感数据（如密码）采用加密存储
  - 传输过程采用HTTPS加密

### 4.3 可用性需求
- **页面引导**：
  - 首次使用提供功能引导
  - 关键操作提供提示和确认
- **错误提示**：
  - 操作失败时显示友好的错误信息
  - 网络异常时提供重试机制
- **移动端体验**：
  - 适配不同屏幕尺寸
  - 支持手势操作
  - 优化加载速度和流畅度

### 4.4 可扩展性需求
- **支持多学校**：
  - 系统设计支持多学校接入
  - 各学校数据隔离
- **支持多城市**：
  - 可扩展支持不同城市的学校
  - 支持城市级别的数据统计
- **支持更多业务**：
  - 模块化设计，便于扩展新功能
  - 提供API接口，支持第三方集成

## 5 其他说明

### 5.1 与第三方服务的依赖
- **微信接口**：
  - 微信登录接口（wx.login）
  - 微信用户信息接口（wx.getUserProfile）
  - 微信支付接口（可选，未来扩展）
- **地图服务**：
  - 当前版本未集成，未来可扩展支持
  - 用于路线规划和距离计算

### 5.2 与若依框架的约束与约定
- **代码结构**：遵循若依框架的代码结构规范
- **数据库设计**：遵循若依框架的数据库设计规范
- **权限管理**：使用若依框架的权限管理机制
- **日志管理**：使用若依框架的日志记录功能
- **异常处理**：遵循若依框架的异常处理机制

## 6 需求变更记录
| 版本 | 变更内容 | 变更时间 | 变更人 |
|------|----------|----------|--------|
| 1.0 | 初始需求文档 | 2025-12-12 | 系统架构师 |